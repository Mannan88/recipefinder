<!-- <div class="ingredients-section">
            <form action="/searchByIngrediants" method="POST">
                <input type="hidden" name="ingredient" value="Eggs">
                <button type="submit">Eggs</button>
            </form>
            
            <form action="/searchByIngrediants" method="POST">
                <input type="hidden" name="ingredient" value="Chicken">
                <button type="submit">Chicken</button>
            </form>
            
            <form action="/searchByIngrediants" method="POST">
                <input type="hidden" name="ingredient" value="Rice">
                <button type="submit">Rice</button>
            </form>
        </div> -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flavour Finder</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  
  <body>
<%- include('partials/navbar.ejs') %>

    <div class="container">
      <!-- Ingredients Section -->
      <div class="ingredients-section">
        <div class="search-bar">
          <form
            id="ingredientSearchForm"
            action="/searchByIngrediants"
            method="POST"
          >
            <input
              type="text"
              name="ingredient"
              placeholder="Search ingredient"
            />
            <button type="submit" class="submit button">Search</button>
          </form>
        </div>
        <div class="ingredients-list">
          <button class="button" data-ingredient="Honey">Honey</button>
          <button class="button" data-ingredient="Flour">Flour</button>
          <button class="button" data-ingredient="Baking Powder">
            Baking Powder
          </button>
          <button class="button" data-ingredient="Butter">Butter</button>
          <button class="button" data-ingredient="Oil">Oil</button>
          <button class="button" data-ingredient="Eggs">Eggs</button>
        </div>
      </div>

      <div id="recipes-container" class="recipes-section">
        <div class="search-barrec">
          <form id="recipeSearchForm">
            <input type="text" name="recipe" placeholder="Search by Recipe" />
            <button type="submit" class="search button">Search</button>
          </form>
        </div>
      </div>
    </div>

<script>
    let selectedIngredients = [];

     $(document).ready(function () {
     $(".button").click(function () {
         const ingredient = $(this).data("ingredient");
         const index = selectedIngredients.indexOf(ingredient);
         if (index === -1) {
             selectedIngredients.push(ingredient);
         } else {
            selectedIngredients.splice(index, 1);
         }
         loadCommonRecipes();
        });
        $("#ingredientSearchForm").submit(function (e) {
          e.preventDefault();
          const ingredient = $("input[name='ingredient']").val().trim();
        if (ingredient && !selectedIngredients.includes(ingredient)) {
            selectedIngredients.push(ingredient);
                $("input[name='ingredient']").val("");
                loadCommonRecipes();
                }
            })
            $("#recipeSearchForm").submit(function (e) {
           const recipeName = $("input[name='recipe']").val().trim();
           e.preventDefault(); // Stop form submission
           if (recipeName) {
               $.ajax({
                   url: "/searchByRecipe",
                   type: "POST",
                   data: { recipe: recipeName },
                   traditional: true,
                   success: function (data) {
                       console.log("Data received from server:", data); // Inspect the structure
                       renderRecipes(data.recipes || []);
                   },
                   error: function () {
                       console.error("Error loading recipes by name.");
                       renderRecipes([]);
                     },
                 });
             }
         });
         function loadCommonRecipes() {
             $.ajax({
                 url: "/searchByIngrediants",
                 type: "POST",
                 data: { ingredients: selectedIngredients },
                 success: function (data) {
                     renderRecipes(data.recipes);
                 },
             });
         }
          function loadSearchedRecipes(recipeName) {
            $.ajax({
                url: "/searchByRecipe",
                type: "POST",
                data: { recipe: recipeName },
                traditional: true,
                success: function (data) {
                    if (!data || !data.recipes) {
                        console.error("Invalid response format:", data);
                        renderRecipes([]);
                        return;
                    }
                    console.log("Data received from server:", data.recipes);
                    renderRecipes(data.recipes);
                },
                error: function () {
                    console.error("Error loading recipes by name.");
                    renderRecipes([]);
                },
            });
        }
        function renderRecipes(recipes) {
            const container = $("#recipes-container");
            container.empty();
            if (!recipes || recipes.length === 0) {
                container.append("<p>No recipes found.</p>");
                return;
            }
            recipes.forEach((recipe) => {
                    container.append(`
            <div class="recipe-card">              
                <img src="${recipe.strMealThumb}" alt="${recipe.strMeal}">
                <div class="recipe-card-details">
                <a href="/recipe/${recipe.idMeal}">     
                    <p>${recipe.strMeal}</p> </a>
              <form action="/favourite" method="POST" style="display:flex; align-items:center">
                 <input type="hidden" name="mealId" value="${recipe.idMeal}">
                 <button type="submit" class="favorite-button">
                  <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" 
                     viewBox="0 0 471.701 471.701" xml:space="preserve">
                    <path d="M433.601,67.001c-24.7-24.7-57.4-38.2-92.3-38.2s-67.7,13.6-92.4,38.3l-12.9,12.9l-13.1-13.1
                      c-24.7-24.7-57.6-38.4-92.5-38.4c-34.8,0-67.6,13.6-92.2,38.2c-24.7,24.7-38.3,57.5-38.2,92.4c0,34.9,13.7,67.6,38.4,92.3
                      l187.8,187.8c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-3.9l188.2-187.5c24.7-24.7,38.3-57.5,38.3-92.4
                      C471.801,124.501,458.301,91.701,433.601,67.001z" 
                      fill="none" 
                      stroke="currentColor" 
                      stroke-width="10"/>
                  </svg>
                 </button>
               </form>
               </div>
            </div>`);})
            ;}
        });
    </script>
</body>

</html>